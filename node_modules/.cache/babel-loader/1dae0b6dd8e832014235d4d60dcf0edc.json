{"ast":null,"code":"import firebase, { db } from '../firebase/firebase';\nimport { GET_POSTS, CREATE_POST } from '../actionConstants';\nimport 'firebase/firestore';\n\nfunction getPosts(data) {\n  return {\n    type: GET_POSTS,\n    data\n  };\n}\n\nfunction createNewPost(post) {\n  return {\n    type: CREATE_POST,\n    data: post\n  };\n}\n\nexport const handleInitialData = () => {\n  return (dispatch, getState, {\n    getFirebase,\n    getFirestore\n  }) => {\n    const firebase = getFirebase();\n    const firestore = getFirebase().firestore();\n    let id;\n    let posts = {};\n    db.collection(\"posts\").get().then(querySnapshot => {\n      querySnapshot.forEach(doc => {\n        id = doc.id;\n        posts[id] = doc.data();\n      });\n      dispatch(getPosts(posts));\n    }).catch(err => {\n      console.log(err);\n    });\n  };\n};\nexport const createPost = (newPost, history) => {\n  return (dispatch, getState, {\n    getFirebase,\n    getFirestore\n  }) => {\n    const firebase = getFirebase();\n    db.collection(\"posts\").add(newPost).then(doc => {\n      console.log('document written successfully with id: ', doc.id);\n      db.doc(`/posts/${doc.id}`).get().then(doc => {\n        let newPostData = {};\n        newPostData = doc.data();\n        newPostData.id = doc.id;\n        dispatch(createNewPost(newPostData));\n        history.push('/');\n      }).catch(err);\n    });\n  };\n};","map":{"version":3,"sources":["E:/react/react-redux/social-app/src/actions/dataActions.js"],"names":["firebase","db","GET_POSTS","CREATE_POST","getPosts","data","type","createNewPost","post","handleInitialData","dispatch","getState","getFirebase","getFirestore","firestore","id","posts","collection","get","then","querySnapshot","forEach","doc","catch","err","console","log","createPost","newPost","history","add","newPostData","push"],"mappings":"AACA,OAAOA,QAAP,IAAmBC,EAAnB,QAA6B,sBAA7B;AACA,SAAQC,SAAR,EAAmBC,WAAnB,QAAqC,oBAArC;AACA,OAAO,oBAAP;;AAEA,SAASC,QAAT,CAAkBC,IAAlB,EAAuB;AACrB,SAAM;AACJC,IAAAA,IAAI,EAAEJ,SADF;AAEJG,IAAAA;AAFI,GAAN;AAID;;AACD,SAASE,aAAT,CAAuBC,IAAvB,EAA4B;AAC1B,SAAM;AACJF,IAAAA,IAAI,EAAEH,WADF;AAEJE,IAAAA,IAAI,EAAEG;AAFF,GAAN;AAID;;AAED,OAAO,MAAMC,iBAAiB,GAAC,MAAI;AACjC,SAAO,CAACC,QAAD,EAAWC,QAAX,EAAqB;AAACC,IAAAA,WAAD;AAAcC,IAAAA;AAAd,GAArB,KAAmD;AACxD,UAAMb,QAAQ,GAACY,WAAW,EAA1B;AACA,UAAME,SAAS,GAACF,WAAW,GAAGE,SAAd,EAAhB;AACA,QAAIC,EAAJ;AACA,QAAIC,KAAK,GAAC,EAAV;AACAf,IAAAA,EAAE,CAACgB,UAAH,CAAc,OAAd,EAAuBC,GAAvB,GACCC,IADD,CACOC,aAAD,IAAmB;AACvBA,MAAAA,aAAa,CAACC,OAAd,CAAuBC,GAAD,IAAQ;AAC9BP,QAAAA,EAAE,GAACO,GAAG,CAACP,EAAP;AACAC,QAAAA,KAAK,CAACD,EAAD,CAAL,GAAUO,GAAG,CAACjB,IAAJ,EAAV;AACE,OAHF;AAIAK,MAAAA,QAAQ,CAACN,QAAQ,CAACY,KAAD,CAAT,CAAR;AACD,KAPD,EAQCO,KARD,CAQOC,GAAG,IAAE;AACVC,MAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACD,KAVD;AAWD,GAhBD;AAiBD,CAlBM;AAoBP,OAAO,MAAMG,UAAU,GAAC,CAACC,OAAD,EAAUC,OAAV,KAAoB;AAC1C,SAAO,CAACnB,QAAD,EAAWC,QAAX,EAAqB;AAACC,IAAAA,WAAD;AAAcC,IAAAA;AAAd,GAArB,KAAmD;AACxD,UAAMb,QAAQ,GAACY,WAAW,EAA1B;AACAX,IAAAA,EAAE,CAACgB,UAAH,CAAc,OAAd,EAAuBa,GAAvB,CAA2BF,OAA3B,EACCT,IADD,CACMG,GAAG,IAAE;AACTG,MAAAA,OAAO,CAACC,GAAR,CAAY,yCAAZ,EAAsDJ,GAAG,CAACP,EAA1D;AACAd,MAAAA,EAAE,CAACqB,GAAH,CAAQ,UAASA,GAAG,CAACP,EAAG,EAAxB,EAA2BG,GAA3B,GACCC,IADD,CACMG,GAAG,IAAE;AACT,YAAIS,WAAW,GAAC,EAAhB;AACAA,QAAAA,WAAW,GAACT,GAAG,CAACjB,IAAJ,EAAZ;AACA0B,QAAAA,WAAW,CAAChB,EAAZ,GAAeO,GAAG,CAACP,EAAnB;AACAL,QAAAA,QAAQ,CAACH,aAAa,CAACwB,WAAD,CAAd,CAAR;AACAF,QAAAA,OAAO,CAACG,IAAR,CAAa,GAAb;AACD,OAPD,EAQCT,KARD,CAQOC,GARP;AASD,KAZD;AAaD,GAfD;AAgBD,CAjBM","sourcesContent":["\r\nimport firebase, { db } from '../firebase/firebase';\r\nimport {GET_POSTS, CREATE_POST} from '../actionConstants'\r\nimport 'firebase/firestore';\r\n\r\nfunction getPosts(data){\r\n  return{\r\n    type: GET_POSTS,\r\n    data\r\n  }\r\n}\r\nfunction createNewPost(post){\r\n  return{\r\n    type: CREATE_POST,\r\n    data: post\r\n  }\r\n}\r\n\r\nexport const handleInitialData=()=>{\r\n  return (dispatch, getState, {getFirebase, getFirestore})=>{\r\n    const firebase=getFirebase();\r\n    const firestore=getFirebase().firestore()\r\n    let id;\r\n    let posts={}\r\n    db.collection(\"posts\").get()\r\n    .then((querySnapshot) => {\r\n      querySnapshot.forEach((doc) =>{\r\n      id=doc.id;\r\n      posts[id]=doc.data();\r\n       });\r\n      dispatch(getPosts(posts))\r\n    })\r\n    .catch(err=>{\r\n      console.log(err)\r\n    })\r\n  }\r\n}\r\n\r\nexport const createPost=(newPost, history)=>{\r\n  return (dispatch, getState, {getFirebase, getFirestore})=>{\r\n    const firebase=getFirebase();\r\n    db.collection(\"posts\").add(newPost)\r\n    .then(doc=>{\r\n      console.log('document written successfully with id: ',doc.id )\r\n      db.doc(`/posts/${doc.id}`).get()\r\n      .then(doc=>{\r\n        let newPostData={}\r\n        newPostData=doc.data()\r\n        newPostData.id=doc.id\r\n        dispatch(createNewPost(newPostData))\r\n        history.push('/')\r\n      })\r\n      .catch(err)\r\n    })\r\n  }\r\n}"]},"metadata":{},"sourceType":"module"}